import{d as L,e as J,a6 as Q,ac as W,M as X,f as w,o as Y,U as ee,n as te,h as c,i as p,a3 as f,a7 as _,a5 as se,ad as ae,u as T,l as a,w as i,ak as v,Z as oe,ae as ne,ap as x,j as ie,a4 as le,ah as y,a8 as ce,aa as re,ab as de}from"./vue-cc42d2bc.js";import{S as ue}from"./sortable.esm-0d19b1d3.js";import{r as pe,p as _e,a as be,u as me,H as he,_ as fe}from"./index-3da832da.js";const S=L({id:"budou-keepAlive",state:()=>({keepAliveName:[]}),actions:{async addKeepAliveName(t){!this.keepAliveName.includes(t)&&this.keepAliveName.push(t)},async removeKeepAliveName(t){this.keepAliveName=this.keepAliveName.filter(e=>e!==t)},async setKeepAliveName(t=[]){this.keepAliveName=t}}}),C=S(),ve=L({id:"budou-tabs",state:()=>({tabsMenuList:[]}),actions:{async addTabs(t){this.tabsMenuList.every(e=>e.path!==t.path)&&this.tabsMenuList.push(t),!C.keepAliveName.includes(t.name)&&t.isKeepAlive&&await C.addKeepAliveName(t.path)},async removeTabs(t,e=!0){const o=this.tabsMenuList;e&&o.forEach((n,k)=>{if(n.path!==t)return;const b=o[k+1]||o[k-1];b&&pe.push(b.path)}),this.tabsMenuList=o.filter(n=>n.path!==t)},async closeMultipleTab(t){this.tabsMenuList=this.tabsMenuList.filter(o=>o.path===t||!o.close);const e=this.tabsMenuList.filter(o=>o.isKeepAlive);await C.setKeepAliveName(e.map(o=>o.path))},async setTabs(t){this.tabsMenuList=t},async setTabsTitle(t){const e=location.hash.substring(1);this.tabsMenuList.forEach(o=>{o.path==e&&(o.title=t)})}},persist:_e("budou-tabs")}),ke=t=>(re("data-v-9fa08072"),t=t(),de(),t),Ae={class:"tabs-box bd-tab bg-white dark:bg-dark"},Te={class:"flex-y-center w-full h-44px"},Ce={class:"flex-1-hidden h-full"},Me={class:"bd-tab-container h-full"},Ne=["onClick"],we={key:0},xe={class:"text"},ye=["onClick"],Le=ke(()=>_("div",{class:"chrome-tab-divider"},null,-1)),Se={class:"h-full flex w-40px items-center justify-center cursor-pointer"},Ke=J({__name:"Tabs",setup(t){const e=Q(),o=W(),n=ve(),k=be(),b=me(),u=S(),M=X(e.fullPath),K=w(()=>n.tabsMenuList),g=w(()=>b.tabsIcon);Y(()=>{P(),z()}),ee(()=>e.fullPath,()=>{var l;if(e.meta.isFull)return;M.value=e.fullPath;const s={icon:e.meta.icon,title:e.meta.title,path:e.fullPath,name:e.name,close:!e.meta.isAffix,isKeepAlive:!!((l=e.meta)!=null&&l.isKeepAlive)};n.addTabs(s)},{immediate:!0});const P=()=>{ue.create(document.querySelector(".bd-tab-container"),{draggable:".bd-tab-item",animation:300,onEnd({newIndex:s,oldIndex:l}){const r=[...n.tabsMenuList],A=r.splice(l,1)[0];r.splice(s,0,A),n.setTabs(r)}})},z=()=>{k.flatMenuListGet.forEach(s=>{if(s.meta.isAffix&&!s.meta.isHide&&!s.meta.isFull){const l={icon:s.meta.icon,title:s.meta.title,path:s.path,name:s.name,close:!s.meta.isAffix};n.addTabs(l)}})},E=s=>{const l=s.path;o.push(l)},R=s=>{const l=n.tabsMenuList.filter(r=>r.path==s)[0].name||"";u.removeKeepAliveName(l),n.removeTabs(s,s==e.fullPath)},N=te("refresh"),j=()=>{setTimeout(()=>{u.removeKeepAliveName(e.name),N(!1),oe(()=>{u.addKeepAliveName(e.name),N(!0)})},0)},V=()=>{b.setGlobalState("maximize",!0)},B=()=>{e.meta.isAffix||(n.removeTabs(e.fullPath),u.removeKeepAliveName(e.name))},F=()=>{n.closeMultipleTab(e.fullPath),u.setKeepAliveName([e.name])},O=()=>{n.closeMultipleTab(),u.setKeepAliveName(),o.push(he)};return(s,l)=>{const r=c("i-bd-close-small"),A=c("i-bd-down"),D=c("i-bd-refresh"),m=c("el-icon"),h=c("el-dropdown-item"),G=c("i-bd-full-screen"),H=c("i-bd-reduce-one"),$=c("i-bd-close-one"),I=c("i-bd-folder-failed"),U=c("el-dropdown-menu"),q=c("el-dropdown");return p(),f("div",Ae,[_("div",Te,[_("div",Ce,[_("div",Me,[(p(!0),f(se,null,ae(T(K),d=>(p(),f("div",{key:d.path,class:ne(["bd-tab-item transition-all-300",T(M)===d.path?"chrome-tab_active":""]),onClick:x(Z=>E(d),["stop"])},[d.icon&&T(g)?(p(),f("div",we,[(p(),ie(le("i-bd-add-text"),{theme:"outline",size:"16",class:"cursor-pointer"}))])):y("",!0),_("span",xe,ce(d.title),1),d.close?(p(),f("div",{key:1,class:"bd-tab-item-colse",onClick:x(Z=>R(d.path),["stop"])},[a(r,{theme:"outline"})],8,ye)):y("",!0),Le],10,Ne))),128))])]),a(q,{trigger:"click",teleported:!1},{dropdown:i(()=>[a(U,null,{default:i(()=>[a(h,{onClick:j},{default:i(()=>[a(m,null,{default:i(()=>[a(D)]),_:1}),v(" 刷新 ")]),_:1}),a(h,{onClick:V},{default:i(()=>[a(m,null,{default:i(()=>[a(G)]),_:1}),v(" 最大化 ")]),_:1}),a(h,{divided:"",onClick:B},{default:i(()=>[a(m,null,{default:i(()=>[a(H)]),_:1}),v(" 关闭当前 ")]),_:1}),a(h,{onClick:F},{default:i(()=>[a(m,null,{default:i(()=>[a($)]),_:1}),v(" 关闭其他 ")]),_:1}),a(h,{onClick:O},{default:i(()=>[a(m,null,{default:i(()=>[a(I)]),_:1}),v(" 关闭所有 ")]),_:1})]),_:1})]),default:i(()=>[_("div",Se,[a(A,{theme:"outline",size:"24"})])]),_:1})])])}}});const ge=fe(Ke,[["__scopeId","data-v-9fa08072"]]),Re=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as T,Re as a,S as u};
