import{_ as ee}from"./index-ed788ec2.js";import{_ as te}from"./index.vue_vue_type_script_name_BdSandMsg_setup_true_lang-42f59eec.js";import{e as ae,ac as oe,r as I,l as t,aC as ne,av as y,ak as l,aD as re,aE as se,aF as w,h as r,aw as le,M as d,ax as ue,E as C,o as ie,ay as de,i as f,j as g,w as u,a7 as i,u as n,af as pe,a3 as ce,ad as _e,a5 as fe,az as $,J as N,aa as me,ab as ve,a4 as be,at as V,a8 as L,ah as we}from"./vue-cc42d2bc.js";import{_ as ge}from"./Devices.vue_vue_type_script_name_Devices_setup_true_lang-16e522dc.js";import{b as he,B as xe,_ as ye}from"./index-3da832da.js";import{u as Ce,d as ke}from"./user-053075e3.js";import{b as F}from"./route-block-83d24a4e.js";import"./message-a13469e4.js";import"./axios-4fe91515.js";const M=m=>(me("data-v-8fcc847e"),m=m(),ve(),m),De={class:"flex-1 el-card border-none flex-col box-border overflow-hidden"},Be={class:"h-50px pl-12px pr-12px box-border flex items-center justify-between bd-title"},ze=M(()=>i("div",{class:"bd-title-left"},[i("p",{class:"m-0 font-600"},"用户列表")],-1)),Ee={class:"flex items-center h-50px"},Ue={class:"flex-1 overflow-hidden p-12px"},Se={class:"bd-card-footer pl-12px pr-12px mb-12px flex items-center justify-between"},Ie=M(()=>i("div",null,null,-1)),T=ae({__name:"userlist",setup(m){const k=oe(),D=he(),P=I([{prop:"name",label:"昵称",fixed:"left",width:140},{prop:"phone",label:"手机号",fixed:"left",width:120},{prop:"username",label:"用户",width:120},{prop:"avatar",label:"头像",align:"center",width:80,render:e=>{let o="";return e.row.uid&&(o=`${xe.APP_URL}users/${e.row.uid}/avatar`),t(ne,{src:o,size:54},{default:()=>[e.row.name]})}},{prop:"uid",label:"用户ID",minWidth:300},{prop:"status",label:"用户状态",width:86,formatter(e){return e.status===1?"正常":"封禁"}},{prop:"short_no",label:"悟空号",width:180},{prop:"sex",label:"性别",width:60,formatter(e){return e.sex===1?"男":"女"}},{prop:"register_time",label:"注册时间",width:170},{prop:"device_name",label:"登录设备",width:140},{prop:"device_model",label:"登录设备型号",width:140},{prop:"online",label:"在线状态",width:90,formatter(e){return e.online===1?"在线":"离线"}},{prop:"last_online_time",label:"最后离线时间",width:150},{prop:"operation",label:"操作",align:"center",fixed:"right",width:180,render:e=>t(le,null,{default:()=>[t(y,{type:"primary",onClick:()=>A(e.row)},{default:()=>[l("发消息")]}),t(re,null,{default:()=>t(y,{class:"bu-button"},{default:()=>[l("更多")]}),dropdown:()=>t(se,null,{default:()=>[t(w,{onClick:()=>O(e.row)},{default:()=>[t(r("i-bd-every-user"),{class:"mr-4px"},null),l("好友列表")]}),t(w,{onClick:()=>R(e.row)},{default:()=>[t(r("i-bd-personal-privacy"),{class:"mr-4px"},null),l("黑名单列表")]}),t(w,{onClick:()=>G(e.row)},{default:()=>[t(r("i-bd-info"),{class:"mr-4px"},null),e.row.status===1?"封禁":"解禁"]}),t(w,{onClick:()=>J(e.row)},{default:()=>[t(r("i-bd-devices"),{class:"mr-4px"},null),l("查看设备")]})]})})]})}]),B=d([]),h=d(!1),z=d(0),s=I({keyword:"",page_size:15,page_index:1}),c=()=>{h.value=!0,ke(s).then(e=>{h.value=!1,B.value=e.list,z.value=e.count})},j=e=>{s.page_size=e,c()},q=e=>{s.page_index=e,c()},v=d(!1),E=d({receivederChannelType:1,receiveder:"",receivederName:"",sender:"",senderName:""}),A=e=>{v.value=!0,E.value={receivederChannelType:1,receiveder:e.uid,receivederName:e.name,sender:D.userInfo.uid,senderName:D.userInfo.name}},O=e=>{k.push({path:"/user/friends",query:{uid:e.uid,name:e.name}})},R=e=>{k.push({path:"/user/userblacklist",query:{uid:e.uid,name:e.name}})},G=e=>{const o=e.status==1?"封禁":"解禁";ue.confirm(`确定要${o}用户${e.name} 吗`,`${o}用户`,{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(()=>{const x={uid:e.uid,status:e.status==1?0:1};Ce(x).then(p=>{c(),C({type:"success",message:`${o}用户成功！`})}).catch(p=>{p.status==400&&C.error(p.msg)})}).catch(()=>{C({type:"info",message:"取消成功！"})})},b=d(!1),U=d(""),J=e=>{U.value=e.uid,b.value=!0};return ie(()=>{c()}),(e,o)=>{const x=r("el-input"),p=r("el-form-item"),W=r("el-form"),H=r("i-bd-setting"),S=r("el-table-column"),K=r("el-table"),Q=r("el-pagination"),X=te,Y=ee,Z=de("loading");return f(),g(Y,{class:"flex-col"},{default:u(()=>[i("div",De,[i("div",Be,[ze,i("div",Ee,[t(W,{inline:""},{default:u(()=>[t(p,{class:"mb-0 !mr-16px"},{default:u(()=>[t(x,{modelValue:n(s).keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>n(s).keyword=a),placeholder:"uid/手机号/用户名",clearable:""},null,8,["modelValue"])]),_:1}),t(p,{class:"mb-0 !mr-0"},{default:u(()=>[t(n(y),{type:"primary",onClick:c},{default:u(()=>[l("查询")]),_:1})]),_:1})]),_:1})])]),i("div",Ue,[pe((f(),g(K,{data:n(B),border:!0,style:{width:"100%",height:"100%"}},{default:u(()=>[t(S,{type:"index",width:42,align:"center",fixed:"left"},{header:u(()=>[t(H,{class:"cursor-pointer",size:"16"})]),_:1}),(f(!0),ce(fe,null,_e(n(P),a=>(f(),g(S,$(a,{key:a.prop}),{default:u(_=>[a.render?(f(),g(be(a.render),{key:0,row:_.row},null,8,["row"])):a.formatter?V(e.$slots,a.prop,{key:1,row:_.row},()=>[l(L(a.formatter(_.row)),1)],!0):a.prop?V(e.$slots,a.prop,{key:2,row:_.row},()=>[l(L(_.row[a.prop]),1)],!0):we("",!0)]),_:2},1040))),128))]),_:3},8,["data"])),[[Z,n(h)]])]),i("div",Se,[Ie,t(Q,{"current-page":n(s).page_index,"onUpdate:currentPage":o[1]||(o[1]=a=>n(s).page_index=a),"page-size":n(s).page_size,"onUpdate:pageSize":o[2]||(o[2]=a=>n(s).page_size=a),"page-sizes":[15,20,30,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:n(z),onSizeChange:j,onCurrentChange:q},null,8,["current-page","page-size","total"])])]),t(X,$({value:n(v),"onUpdate:value":o[3]||(o[3]=a=>N(v)?v.value=a:null)},n(E)),null,16,["value"]),t(ge,{value:n(b),"onUpdate:value":o[4]||(o[4]=a=>N(b)?b.value=a:null),uid:n(U)},null,8,["value","uid"])]),_:3})}}});typeof F=="function"&&F(T);const qe=ye(T,[["__scopeId","data-v-8fcc847e"]]);export{qe as default};
