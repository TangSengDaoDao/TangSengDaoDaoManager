import{_ as Y}from"./index-ed788ec2.js";import{_ as Z}from"./index.vue_vue_type_script_name_BdSandMsg_setup_true_lang-42f59eec.js";import{e as ee,ac as oe,r as N,l as o,aC as te,av as k,ak as u,aD as ae,aE as ne,aF as m,h as r,aw as re,M as g,ax as $,E as c,o as se,ay as le,i as b,j as h,w as p,a7 as d,u as n,af as ue,a3 as pe,ad as de,a5 as ie,az as E,J as ce,aa as _e,ab as fe,a4 as me,at as F,a8 as S}from"./vue-cc42d2bc.js";import{B as ge,_ as be}from"./index-3da832da.js";import{b as we,c as xe,d as he}from"./group-1872a9ab.js";import{b as L}from"./route-block-83d24a4e.js";import"./message-a13469e4.js";import"./axios-4fe91515.js";const T=w=>(_e("data-v-537eb232"),w=w(),fe(),w),ve={class:"flex-1 el-card border-none flex-col box-border overflow-hidden"},ye={class:"h-50px pl-12px pr-12px box-border flex items-center justify-between bd-title"},ke=T(()=>d("div",{class:"bd-title-left"},[d("p",{class:"m-0 font-600"},"群列表")],-1)),Ce={class:"flex items-center h-50px"},Be={class:"flex-1 overflow-hidden p-12px"},De={class:"bd-card-footer pl-12px pr-12px mb-12px flex items-center justify-between"},ze=T(()=>d("div",null,null,-1)),I=ee({__name:"grouplist",setup(w){const v=oe(),M=N([{prop:"name",label:"群名称",fixed:"left",width:200},{prop:"group_no",label:"群编号",fixed:"left",width:200},{prop:"avatar",label:"群头像",align:"center",width:100,render:e=>{let t="";return e.row.group_no&&(t=`${ge.APP_URL}groups/${e.row.group_no}/avatar`),o(te,{src:t,size:54},{default:()=>[e.row.name]})}},{prop:"status",label:"群状态",width:80,formatter(e){return e.status===1?"正常":"封禁中"}},{prop:"member_count",label:"群人数",width:80},{prop:"create_name",label:"群主名称"},{prop:"creator",label:"群主ID"},{prop:"create_at",label:"创建时间",width:180},{prop:"operation",label:"操作",align:"center",fixed:"right",width:180,render:e=>o(re,null,{default:()=>[o(k,{type:"primary",onClick:()=>P(e.row)},{default:()=>[u("发消息")]}),o(ae,null,{default:()=>o(k,{class:"bu-button"},{default:()=>[u("更多")]}),dropdown:()=>o(ne,null,{default:()=>[o(m,{onClick:()=>A(e.row)},{default:()=>[o(r("i-bd-every-user"),{class:"mr-4px"},null),u("群成员")]}),o(m,{onClick:()=>j(e.row)},{default:()=>[o(r("i-bd-log"),{class:"mr-4px"},null),u("聊天记录")]}),o(m,{onClick:()=>q(e.row)},{default:()=>[o(r("i-bd-people-unknown"),{class:"mr-4px"},null),u("黑名单成员")]}),o(m,{onClick:()=>O(e.row)},{default:()=>[o(r("i-bd-forbid"),{class:"mr-4px"},null),e.row.forbidden===1?"禁言中":"禁言"]}),o(m,{onClick:()=>R(e.row)},{default:()=>[o(r("i-bd-info"),{class:"mr-4px"},null),e.row.status===1?"封禁":"解禁"]})]})})]})}]),C=g([]),y=g(!1),B=g(0),l=N({keyword:"",page_size:15,page_index:1}),i=()=>{y.value=!0,he(l).then(e=>{y.value=!1,C.value=e.list,B.value=e.count})},U=e=>{l.page_size=e,i()},V=e=>{l.page_index=e,i()},x=g(!1),D=g({receivederChannelType:1,receiveder:"",receivederName:"",sender:"",senderName:""}),P=e=>{x.value=!0,D.value={receivederChannelType:2,receiveder:e.group_no,receivederName:e.name,sender:e.creator,senderName:e.create_name}},A=e=>{v.push({path:"/group/groupmembers",query:{groupNo:e.group_no,name:e.name}})},j=e=>{v.push({path:"/message/record",query:{groupNo:e.group_no,name:e.name}})},q=e=>{v.push({path:"/group/groupblacklist",query:{groupNo:e.group_no,name:e.name}})},O=e=>{const t=e.forbidden==1?"禁言":"解除禁言";$.confirm(`确定要对群组${e.name}${t}吗?`,`${t}群组`,{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(()=>{const _={groupNo:e.group_no,forbidden:e.forbidden==1?0:1};we(_).then(s=>{i(),c({type:"success",message:`${t}群组成功！`})}).catch(s=>{s.status==400&&c.error(s.msg)})}).catch(()=>{c({type:"info",message:"取消成功！"})})},R=e=>{const t=e.status==1?"封禁":"解禁";$.confirm(`确定要对群组${e.name}${t}吗?`,`${t}群组`,{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(()=>{const _={groupNo:e.group_no,status:e.status==1?0:1};xe(_).then(s=>{i(),c({type:"success",message:`${t}群组成功！`})}).catch(s=>{s.status==400&&c.error(s.msg)})}).catch(()=>{c({type:"info",message:"取消成功！"})})};return se(()=>{i()}),(e,t)=>{const _=r("el-input"),s=r("el-form-item"),G=r("el-form"),J=r("i-bd-setting"),z=r("el-table-column"),H=r("el-table"),K=r("el-pagination"),Q=Z,W=Y,X=le("loading");return b(),h(W,{class:"flex-col"},{default:p(()=>[d("div",ve,[d("div",ye,[ke,d("div",Ce,[o(G,{inline:""},{default:p(()=>[o(s,{class:"mb-0 !mr-16px"},{default:p(()=>[o(_,{modelValue:n(l).keyword,"onUpdate:modelValue":t[0]||(t[0]=a=>n(l).keyword=a),placeholder:"群名称/群编号",clearable:""},null,8,["modelValue"])]),_:1}),o(s,{class:"mb-0 !mr-0"},{default:p(()=>[o(n(k),{type:"primary",onClick:i},{default:p(()=>[u("查询")]),_:1})]),_:1})]),_:1})])]),d("div",Be,[ue((b(),h(H,{data:n(C),border:!0,style:{width:"100%",height:"100%"}},{default:p(()=>[o(z,{type:"index",width:42,align:"center",fixed:"left"},{header:p(()=>[o(J,{class:"cursor-pointer",size:"16"})]),_:1}),(b(!0),pe(ie,null,de(n(M),a=>(b(),h(z,E(a,{key:a.prop}),{default:p(f=>[a.render?(b(),h(me(a.render),{key:0,row:f.row},null,8,["row"])):a.formatter?F(e.$slots,a.prop,{key:1,row:f.row},()=>[u(S(a.formatter(f.row)),1)],!0):F(e.$slots,a.prop,{key:2,row:f.row},()=>[u(S(f.row[a.prop]),1)],!0)]),_:2},1040))),128))]),_:3},8,["data"])),[[X,n(y)]])]),d("div",De,[ze,o(K,{"current-page":n(l).page_index,"onUpdate:currentPage":t[1]||(t[1]=a=>n(l).page_index=a),"page-size":n(l).page_size,"onUpdate:pageSize":t[2]||(t[2]=a=>n(l).page_size=a),"page-sizes":[15,20,30,50,100],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:n(B),onSizeChange:U,onCurrentChange:V},null,8,["current-page","page-size","total"])])]),o(Q,E({value:n(x),"onUpdate:value":t[3]||(t[3]=a=>ce(x)?x.value=a:null)},n(D)),null,16,["value"])]),_:3})}}});typeof L=="function"&&L(I);const Me=be(I,[["__scopeId","data-v-537eb232"]]);export{Me as default};
