import{_ as M}from"./index-ed788ec2.js";import{a as N,b as z,c as L}from"./user-053075e3.js";import{e as E,U as O,M as y,r as A,h as r,i as g,j as x,w as l,l as a,ak as v,u as s,E as B,aC as q,av as S,aw as F,ax as P,o as j,ay as G,a7 as b,af as J,a3 as H,ad as K,a5 as Q,J as W,aa as X,ab as Y,az as Z,a4 as ee,at as $,a8 as I,ah as ae}from"./vue-cc42d2bc.js";import{B as oe,_ as le}from"./index-3da832da.js";import{b as R}from"./route-block-83d24a4e.js";import"./axios-4fe91515.js";const te=E({name:"AdminAdd"}),ne=E({...te,props:{value:{type:Boolean,default:!1}},emits:["update:value","ok"],setup(_,{emit:k}){const m=_;O(()=>m.value,(o,n)=>{var i;m.value=o,o||(i=c.value)==null||i.resetFields()});const p=y(!1),c=y(),d=A({name:"",login_name:"",password:""}),f=A({name:[{required:!0,message:"请输入姓名",trigger:"blur"}],login_name:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),w=()=>{k("update:value",!1)},t=()=>{var o;(o=c.value)==null||o.validate((n,i)=>{n&&(p.value=!0,N(d).then(u=>{p.value=!1,u.status==200&&(B.success("新增成功！"),w(),k("ok",!0))}).catch(u=>{p.value=!1,u.status==400&&B.error(u.msg)}))})};return(o,n)=>{const i=r("el-input"),u=r("el-form-item"),C=r("el-form"),V=r("el-button"),D=r("el-space"),U=r("el-dialog");return g(),x(U,{"model-value":o.value,width:460,"align-center":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,draggable:!0,"z-index":99,title:"新增管理员",onClose:w},{footer:l(()=>[a(D,null,{default:l(()=>[a(V,{onClick:w},{default:l(()=>[v("取消")]),_:1}),a(V,{type:"primary",loading:s(p),onClick:t},{default:l(()=>[v("确定")]),_:1},8,["loading"])]),_:1})]),default:l(()=>[a(C,{ref_key:"formRef",ref:c,model:s(d),rules:s(f)},{default:l(()=>[a(u,{label:"姓名",prop:"name"},{default:l(()=>[a(i,{modelValue:s(d).name,"onUpdate:modelValue":n[0]||(n[0]=e=>s(d).name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),a(u,{label:"账号",prop:"login_name"},{default:l(()=>[a(i,{modelValue:s(d).login_name,"onUpdate:modelValue":n[1]||(n[1]=e=>s(d).login_name=e),placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),a(u,{label:"密码",prop:"password"},{default:l(()=>[a(i,{modelValue:s(d).password,"onUpdate:modelValue":n[2]||(n[2]=e=>s(d).password=e),type:"password","show-password":"",placeholder:"请输入密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}}),se=_=>(X("data-v-ee5728bc"),_=_(),Y(),_),re={class:"flex-1 el-card border-none flex-col box-border overflow-hidden"},de={class:"h-50px pl-12px pr-12px box-border flex items-center justify-between bd-title"},ue=se(()=>b("div",{class:"bd-title-left"},[b("p",{class:"m-0 font-600"},"管理员")],-1)),ie={class:"flex items-center h-50px"},pe={class:"flex-1 overflow-hidden p-12px"},T=E({__name:"index",setup(_){const k=A([{prop:"avatar",label:"头像",align:"center",width:80,render:t=>{let o="";return t.row.uid&&(o=`${oe.APP_URL}users/${t.row.uid}/avatar`),a(q,{src:o,size:54},{default:()=>[t.row.name]})}},{prop:"uid",label:"用户ID"},{prop:"name",label:"昵称"},{prop:"username",label:"用户"},{prop:"register_time",label:"注册时间"},{prop:"operation",label:"操作",align:"center",fixed:"right",width:100,render:t=>a(F,null,{default:()=>[a(S,{type:"danger",onClick:()=>w(t.row)},{default:()=>[v("删除")]})]})}]),m=y(!1),p=y([]),c=()=>{m.value=!0,L().then(t=>{m.value=!1,p.value=t})},d=()=>{c()},f=y(!1),w=t=>{P.confirm(`确定要删除管理员${t.name} 吗`,"删除管理员",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(()=>{const o={uid:t.uid};z(o).then(n=>{c(),B({type:"success",message:"删除管理成功！"})}).catch(n=>{n.status==400&&B.error(n.msg)})}).catch(()=>{console.log("取消")})};return j(()=>{c()}),(t,o)=>{const n=r("el-form-item"),i=r("el-form"),u=r("i-bd-setting"),C=r("el-table-column"),V=r("el-table"),D=M,U=G("loading");return g(),x(D,{class:"flex-col"},{default:l(()=>[b("div",re,[b("div",de,[ue,b("div",ie,[a(i,{inline:""},{default:l(()=>[a(n,{class:"mb-0 !mr-0"},{default:l(()=>[a(s(S),{type:"primary",onClick:o[0]||(o[0]=e=>f.value=!0)},{default:l(()=>[v("新增管理员")]),_:1})]),_:1})]),_:1})])]),b("div",pe,[J((g(),x(V,{data:s(p),border:!0,style:{width:"100%",height:"100%"}},{default:l(()=>[a(C,{type:"index",width:42,align:"center",fixed:"left"},{header:l(()=>[a(u,{class:"cursor-pointer",size:"16"})]),_:1}),(g(!0),H(Q,null,K(s(k),e=>(g(),x(C,Z(e,{key:e.prop}),{default:l(h=>[e.render?(g(),x(ee(e.render),{key:0,row:h.row},null,8,["row"])):e.formatter?$(t.$slots,e.prop,{key:1,row:h.row},()=>[v(I(e.formatter(h.row)),1)],!0):e.prop?$(t.$slots,e.prop,{key:2,row:h.row},()=>[v(I(h.row[e.prop]),1)],!0):ae("",!0)]),_:2},1040))),128))]),_:3},8,["data"])),[[U,s(m)]])])]),a(ne,{value:s(f),"onUpdate:value":o[1]||(o[1]=e=>W(f)?f.value=e:null),onOk:d},null,8,["value"])]),_:3})}}});typeof R=="function"&&R(T);const be=le(T,[["__scopeId","data-v-ee5728bc"]]);export{be as default};
